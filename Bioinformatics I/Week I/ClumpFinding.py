def ComputingFrequencies(Text, k):
	L = len(Text)
	FrequencyDict = {}
	for i in range(L - k + 1):
		Pattern = Text[i:i+k]
		if Pattern in FrequencyDict.keys():
			FrequencyDict[Pattern] += 1
		else:
			FrequencyDict[Pattern] = 1
	return FrequencyDict

def ClumpFinding(genome, k, L, t):
	total = len(genome)
	ClumpedPatterns = set()
	for i in range(total - L + 2):
		window = genome[i:i+L]
		FrequencyDict = ComputingFrequencies(window, k)
		for key, value in FrequencyDict.iteritems():
			if value >= t:
				ClumpedPatterns.add(key)
	return ClumpedPatterns

def FasterClumpFinding(genome, k, L, t):
	total = len(genome)
	ClumpedPatterns = set()
	FrequencyDict = ComputingFrequencies(genome[0:L], k)
	for key, value in FrequencyDict.iteritems():
			if value >= t:
				ClumpedPatterns.add(key)
	for i in range(1, total - L + 2):
		decrease_kmer = genome[i - 1: i - 1 + k]
		FrequencyDict[decrease_kmer] -= 1
		increase_kmer = genome[i + L - k: i + L]
		if increase_kmer in FrequencyDict.keys():
			FrequencyDict[increase_kmer] += 1
		else:
			FrequencyDict[increase_kmer] = 1
		if FrequencyDict[increase_kmer] >= t:
			ClumpedPatterns.add(increase_kmer)	
	return ClumpedPatterns

from collections import defaultdict

def FastestClumpFinding(genome, k, L, t):
    pos = defaultdict(list)
    for i in range(len(genome) - k + 1):
        kmer = genome[i:i + k]
        pos[kmer].append(i)
        
    for kmer in pos:
        for p1, p2  in zip(pos[kmer], pos[kmer][t - 1:]):
            if p2 - p1 + k <= L:
                yield kmer
                break

genome = 'GACACGCAAATGTATAGGGGTATCAATTCTTCATTGGCGCAGCCTAATTCACGTTGGTTCGGCGTCGGCCTTACATCAGTCTTACTAGTGTTTCCGGGTGTGTTGACTTCACGCAATAGCCGAGAGGATATGGCTGCGGGGTCAGGCTCGCCAGGCGCTACTGTCTGCAAACCAGATATCCCAAAGGACTCATAAGCCTACTGACCCTCACCCAGACGTTTTAGACTGGTGTTCTCTTTCGCGTGCACGGACCCGAGACTCATTCTGGTGAGCAGTGTGTCCTATTAGGATCCTCTCTTAGATCAGGTCCGGGAGCATAGCACCTTCCAGGTCTGCGGATCTGCCGAATCGGTGGGGATAGAGTTGGGCAGTATACTACGTCAATTTTGGAGCAGGCTTGAGGGCCTTAGAAGTGTTATCACACGGTCAGGGTCATGAGCGGAATATGTGACGTGGGCTGAGGCCACGATCCGTCTTGTCGGGGCGGACGTATCTCTGTGCTCCTCACGGATAACCTGTTCGTGATAAGTGTTTGGGAGCTACGTTGCAAGGTCCACAGAGTTATTTGGATACGCTCAGATAGCTGAACATGGACGGACGAGGTGGTTTATAGCCCGCCTTGCGGGCCTTCACATTGCAGTCCCGAGCGTAGCCTGGTGGTTGGTAATCCATACCATCGCCTAATTCAGGTTCATCCCTACCTTCGCCCCCTGCAGTCCAACTGGGGTCACTGGTGAATACTCTGCTCAATTATCTCAAGTCTGTAACCGTGCCCATCGTAGAAATGTGGGATCACCGATCAACGATGAACGATACCCGCCTACGTAACATGTACTTAGACCGTAGGCTAGAAATCCCTGCCAACGTTACGTCGGTGCAGCTAGATACTTCCGACCGGCCTAAAATATGCCGGGGCAGCACGAGTATAATGAAGACCTAATGTCTCGCCCTTCTGTATTGCCCTATTATGCCTTCTTCTCCATCGCCCAGTCGCGACCAAAAGATAGCTAAGGGATGTTGCGGTAACTACCCATGCGCATACGTTAATAGTTCAAGTTGTCCGTTGAAATACCGTCAGATATTGTCCGTTGAAAGTTGAAAATGTAATTGTCCTGTCCGTTGAAAGTCCGTTGAAATGAGTTCCTCATCTTCTCGGTGTCCGTTGAAATGTCCGTTGAAATGTCCGTTGAAACATACCATGTCCTGTCCGTTGAAAAGCTCCCTTTAGTGTCCGTTGAAACGTGGTGTCCGTTGAAAAAGACGGGGGATTCATCACCTATGTCCGTGTCCGTTGAAAAAAGCTCTTTCTGAAAGACCAGGCGCAAACTTCGGGGGCTGTCCGTTGAAATCACCTCGTGTTGTCCGTTGAAAATGTAGTAACGTTGTCTGTCCGTTGAAAGTCCGTTGAAACGTTGTCCGTTGATGTCCGTTGAAACGATTCTGTCCGTTGAAATTTATGTCCTGTCCGTTGAAATAAACTCACTATCGTATACGTTGTCCGTTGAAATAGGGATGGGATGGCGGTGGGGCATGACCGCTCGATCTAGCTTCCGGAGTTTGTCCGTTGAAAGAAAGGTATTTGTCCGTTGAAACATGAGCCCCCTCAAAATGTCCGTTGAAAATGTCCGTTGAAAGATGCCACCTCGCCCAATTATATATGTCTGCTCCAGTTCTTGAGTGCACCTTAGAGAGTTAGCGGAACGCCTATGGGTGGAAAGGTAGAGTCAGGCGAAAGCGGGTTCTTTTCGTTAGCGTACTAGTCGTGGTATCTAGGAGGAGGAGGTGGCTTTCAGTTGAGTTAGATTGTTCACCCTTGGTCGGCTCGGGCTGGAGGAAAACTGGAACAGACGCAATAGGTTACTCACTGGGACCCCAGGGTCGGTACGAATTATTGTCTTTATGAGAGGGGCGGACTGCGTACAGGCTTTTTTTATCATGGAGATAAAATCAGGCAGGCCGAGTAAAAAGATAGGGCTCCGCGCATGATACGCTGGAGATACAGATACATTCTCCTCGATCAGTGTTTTGTAGGATAAGGACCCTTTTGAGCAACCTCCGATGACTCCGATGATGCCGACTCTACCGGGACCCTGAGGGATCCGGAAACAACCTAATTAACCTCCGAAACCTCCGATGAGACAACCTCCGATGAGGATGCGGGGTGCGGCACTGGGAAACCTCCGATGAAACCTAGAGCACCTTTACTCAACCTCCGATGATCCGATGAGTTAGACGTTCGGCTACCTCTGAATTTCCAGTAACCTCAACCTCCGAAACCTCCGATGAAACCTCCGAATCGCACTAGGAAAGGGTTACAACCAATCGCACTAGGATAGGAGGAAACAATCGCACTATCGCACTAGGACTATAACCTCCGATGAACCTATCGCACTAGGACGCTCCTTTCCAACCTCCGATGATCATCGCACTAGGAGATGAATCGCACTAGGACGCACTAGGATCGCACTAGGAGGAGAAGTAAATACGTACATCGCACTAGGAGATGACGCTTAGACGCTCGCATATCGCACTAGGAAGGACAAAACCTCCGATGAAATCGCACTAGGACGATGATCCTGTCAAAGGAAGCCCAAGTTAGATAATACAACCTCCGATGAGTGATCGCACTAGGAAGTATGGTAGAAATCGCACTAGGACAATTGTAGGGATCGCACTAGGACTAGGAGAGATCGCACTAGGATCGCACCGACGCCTCCAGGATATCGCACTAGGAGCACTATCGCACTAGGACGCCGAATCGCACTAGGAGTCAGATCATCGCACTAGGATATCGCACTATCGCACTAGGAAGCCCACTTTTCTTGTATAATCGCACTAGGAGACAACTCGCAGTCGATGACTTGCATGCCGAAGAGGGGTGATCTCTCCGTCCAAGCCAAGGTCCAAGATTCTCCGTCCAAGATCTCCGTCCAAGTGATAACGTCTCCGTCCAAGGCCTCCTGATAACGTCTCCGTCCAAGACGCTGGAAATTCTCCGTCCAAGTTATAATGATAACGCTGGTTTGATAACGCTGGCGCTGGTGATAACGCTGGTGGGCATTCACCATGACCATGATGATCTCTCTCCGTCCAAGGATAACGCTCTCCGTCCAAGCTCTCCGTCCAAGTGCTTAGCCATTCACCATTCACCATGATACCCATTCACCATGACTCATTGATCTCCGTCCAAGACCTCTCCGTCCAAGCACCACATTCTGATAACGCTGGATGCCACTGATAACGCTGGACGCTGGTGTCTCCGTCCAAGGCTGATAACGCTGGTAACGTCTCCGTCCAAGCGATCTCCGTCCAAGATCTCCGTCCAAGCGTCCAAGTGGCAGTCTCCGTCCAATCTCCTCTCCGTCCAAGGTCCAAGGTCCAAGAAGCGTCTCTCCGTCCAAGGTCCAAGGTGCAATTAGTGCTCACAAACCGTATTCTCTTCTCCGTCCAAGTACTGTCTCTCCGTCCAAGGCCATTCACCATGACATTTCATTCACCATGAGAACTTCGTTGTAGGTTTTCTCCCGAGTGGCATTCACCATGAAAGCGTTACATTCACCATGAAGACGTAAAAGAGATTGTTAAACTGGCCCATTCACCATGACCATTCACCATGACTCATTCACCATGCAATAACAATAACTATTATAACTACAATCAATAACTATTATACCCAATAACAATAACTATTATATTAAATTGTATGAATGTCCCAATAACTATTATTGTTTACCCGCTCTGGTAAATCCCTGAGCAAGAATAGCAGTAACAATAACTATTAGCAATAACTATTAGGATAACACACAGAGGGGTCGCGTAGCAGATTCGTGTGCAATAACTATTAGCCTAAATTGGCTGGCCGACGCAACGCAATCAACAATAACTATTAATTCGCAATAACTATTCAATAACTATTAACAATAACTATTACTATTATTGAACAATAACTATTAATACAATAACTATTACCAATAACTATTAGTCTTAGGTATCGATTGCCTCGAACCACACCCAGCTTAGGTATCGATCAATAACTCAATAACTATTATATCGACTTAGGTCTCAATAACTATTACACAAAGGTACCAACACAAAGGTCGAGGCCAATAACTATTATCGAGTACACGCCAATAACTATTAATAACTATTAAAAGGGGAGGGCTTACTTCAATAACTATTAAAGACCAACACAAAGGGGTACCAACACACCAACACAAAGGAAGGAACCGTTTACTCAAGATTCTGAGCGCCAAGCTGGCTTAGGTATCCAACACAAAGGACAAAGGAAAATGAGCCTTGATCTTAGGTATCGACTCTTAGGTATCGAAGTCATCCGCTTAGGTATCGCCAACACAAAGGTTAGGTATCGATAGGTATCGATCCACCCATTGACCTCTTACTTCTTAGGTACCAACACAAAGGGTCCGTCCAACACAAAGCCAACACAAAGGACCAACACAAAGGCCCAACACAAAGGCAACACAAAGGAACCAACACCAACACAAAGGAACACAAACCAACACAAAGGACACAAAGGCGTGCGTCCGTCCATCGGTTTTCACGTTCCAACACAAAGCCAACACAAAGGTGCAACAACTTAATGAGATACCCCAACACCAACACAAAGGAGGAACACAAAGGGAAGCCAACACAAAGGGAGTACATCTGACCCTGAAAAAGTCAAACGCGACGAGCAATGAGGGCGAAATGACTGGTCTAGGGAATGCCAGAGACTTGGGAAGCTTCTCACTTCCCTATCAGAACTAGGCAACATTGTGGTTTCTGCTTGGATGATTTTTGTTCAGCCGGTGGCTCCAAACGTCAAAGGAGTTATCAAACTCGGGTTCGCTTGCTTGGATTCCCTCGCTTGCTTGGGGATGGATAACGTCGATGTTATCGCTTGCTTGGTCGCTTGCTTGGGGCTCGCTTGCTTGGTTGCTTGGCATCACTCGGTGGCTCCGGTGGCTCGCTTCGCTTGCTTGGGGTGGCTCCAAAGTGGCTCCAATCGCTTGCTTGGTTGCTTGGCTCCAAATCAACAGGGGTGGCTTCGCTTGCTTGGAGGTGGCTCCAAATTCGCTTGCTTGGAACATTAGACTTCGCTCGCTTGCTTGGTCCAAACTCCAAATCCAAAGGTGGCTTCGCTTCGCTTGCTTGGCCAAAACCTAAGGATACGGTGTCGCTTGCTTGGTCCTCGCTTGCTTGGATGACACTAGGTGGCTCGCTTGCTTGGTGCTTGGCTTTCGCTTGCTTGGCTTGGCATTCTGGGGTGGCTCCAAACTCTCGCTTGCTTGGACAAATCGCTTGCTTGGGTCGCTTGCTTGGCGTCTGCTCTCGCTTGCTTGGGTTCCCAGCGGTAAAGGGTTTCGTCGCTTGCTTGGTGCCAACATATATTGTTATGGAGACTTCGCTTGCTTGGTCGCTTGCTTGGTTGGTGTGATTACATAAAGGCTCCTTTAAGTAAAGGCTCCTTTATTCGCACCCTTAAGGCTCCTTTACGCAAGGCTCCTTTAGGCTCCTTTAAGGCTCCTTTAGTGAGAGGTCGTCCCGCAACTCTGCCGCAAGGCTAAGGCTCCTTTAATTAACAGGAAGATGTACGCAAAGGCTCCTTTAGAAGGCAAGGCTCCTTTATCCCACTGCCCGCATAGGATGACCCATATTGATCCTACGGGCTCACTTAAAGGCTCCTTTACACTTGCCCGGTACAACCGATCGCGGCAAGGCTCAAGGCTCCTTTAGCTCCTTTATTAAATAAAGGCTCCTTTACTAGAAAAAAAGGCTCCTTTAAAGGCTCCTTTACCTTTACTGGGGTTCTTTCGAACGAAGGCTCCTAAGGCTCCTTTAAGAAGGCTCCTTTAGCTCCTTTAAAAGGCTCCTTTAAAAAGGCTCCTTTACTGTAAGGCTCCTTTAAGGCTCCTTTATAAGGCTCCTTTAACCTGGTATCAACCGACCTGAAGGCTCCTTTAAAGGCTCCTTTAGAGGGTTAAAGGCTCCTTTATATCTACGGAAGGCTCCTTTATTTTAAAAGGGTGACGTCGGAGTAAAGGGTGACGTGGACAAACCGTAGAATAAAGGGTGACGTGTGGGATTATAAAAGGGTGAAAAGGGTGACGTGACCTAGACGTCTTTACAAAGGGTGACGTTTTTCTAAAGGGTGACGTTGAAAAGGGTGACGTCGTAGCAACACGATGCAAAAGGGTGACGTAAAAGGGTGACAAAGGGTGACAAAGAAAGGGTGACGTTAACATCGAAAAAGGGTGACAAAGGGTGACGTACGTTGACGTCGTAAAGGGTGAAAGGGTGACGTGCTGCGAAAAGGGTGACGTAATCCAGTGGACAATCCAGATTTCCCCAGTTAAAGGGTGACGTAAGCATCACAAAGGGTGACGTACTTCTACCACTTGGTCATTTCGTGCCGATTCCAGCCGCTCCGAGACCATATAAATAACGTTGTCAGTGTCACAAAGGGAAAGGGTGACGTCAAAGGGTGACGTACGTCTGGAAGAGGCCTTTCGAGCGTAAGGTTGCTGAAGAAAGGGTGACGTGTGAAAGGGTGACGTTACGCTAAAGGGTGACGTTTTTATTAGTAAAGGGTGACGTTAAGAGGTACTATCACGTACTAGAATAATCATCTGCTAAGAGGCTAAGAGCACGTACTATCCGCTAAGCTCAAATCTGCTAAGAGGCTAAGAGGTAATCTGCTAAGAGGAGGTCACGTACTAAAGCCGTCACGTACTATCTAACATCTGCTAAGAGTATATAAGCTACGAACGGTACACGTGGGCGTCATATCTGCTAAGAGGTTGTAATCACCGTCACGTAATCTGCTAAGAGAGCGTCCGTCACGTAATCTGCTAAGATCTGCTAAGAGCTCATCGCATGAATCTGCTAAGAGAAGAGTTGTCCCTACATCTGCTAAGAGTGCGGTCTAGTTCGTCACGTACTAACAGACGTCACGTACATCTGCTAAGAGATGCGTCACGTACTACTCGTCACGTATCTGCTAAGAGACTACCCTGGTAAATAATCTGCTAAGAGTCAATCTGCTAAGAGTACTATCACGTACTATGATCACTGCTTGTAATTAGATCTGCTAAGAGTAAGCACTGCTTGTAACTGCTAAGAGTAAGAGGTACTATAGGGCCCACACTCACTGCTTGTCCACTGCTTGTCACTGCTTGTAATAATGCTTGTACACTGCTTCACTGCTTGTAATGTAATCAACACTGCTTGTACACTGCTTGTAAACTGCTTGTACACTGCTTGTAATTTGCGTTGCAGGCACACTGCTTGTAAACGAAGGGACACTGCTTGTAAAAAAATATGAGGTCACTGCTTGTAACGAGCTCACTGCTTGTAAGTTACCGCCGAAGTTGCTTCAAATAACACTGCTTGTAATTCTATCAGGTATCCGCCCTGTACGAACCACTGCTTGTAATAGGATTGCACTGCTTGTAACTGTTCCACTGCTTGTAACTTGTAATCACTGCTTGTAAAGCCACTGCTTGTAACACATTAGACACTGCTTGTAAACTGCTTGTAAAGAGCCAGGACATCAGGTGGGCCCACCACTGCTTGTAAACGGCATGGTGTCGCAAATTCACTGCTTGTAATCACTGCTCACTGCTTGTAACTTGTAAGTTCCCGACAGCGACACTGCTTGTAACAGCCTCTCTCCTCGCTCGACAGCCTCTCCGCGGGATGGCGTTGACATGAATTTACGACACGACAGCCTCTCCCCTCTGCTAGCACTAGCAAATATAGGGCGTGCGACAGCCTCTCCCTGCGACAGCCTCTCACCGACAGCCGACAGCCTCTCGCCTCTCCTAAATACGTGCTCTTTGCACGTCCTTTCATCCGACAGCCTCTCTCTGCTGACAAGGCCCCTTCGACAGCCTCTCGACAGCGACAGCCTCTCCTCTCTCCGACAGCCTCTCCACTGCGGAATTTACTAGCCGACAGCCTCTCAGCCCCGGGTAAGGATGGAGGTTTCTATCGGAAGCGACAGCCTCTCTCATTGTACACTGGCCTCGACAGCCTCTCCAGCCCGACAGCCTCTCCAGCCTCTCGACAGCCTCTCCTTACCTCTTACCTGTAGCCAAGGCCTTACCTGTAGCCCCGACAGCCTCGACAGCCTCCGACAGCCTCTCTGTAGCACAGCCCGACAGCCTCTCCGACAGCCTCTCCTCGACAGCCTCTCACTTACCTGCTTACCTGTAGCCTTCGCTTACCTGTAGCTGTAGAGGGACATCAAGAACTTACCTGTAGCCTCAGAAATCCCTTTGCAGGGACATCAAGACATCAAGCTTACCTGTAGCCTGTAGCGAATCATGAATGGGCCCCTTACCTGTAGCAAGGGACATCAAGGACATCAAGTACCAGGGACATCAAGATCTTGAAGGGACATCAAGGGACATCAAGACCTGTAGCGAGGGAAGGGACATCAAGCCTGTCTTAAGGGACATCAAGATCAAGGCATTCGATACCTCATATCGTCAGGGACATCAAGAGGGAAGGGACATCAAGGGACATCAAGGCCCTTACCTGTAGCTGGTGAGCGAGGGACATCAAGTGTAGCTAGCGCCACGCCCTCTTACCTGTAGCTTACCTAGGGACATCAAGCTGTAGCAGCGTAGGGACAGGGACATCAAGCAAGATCAAGACGAGCAAGGGACATCAAGAAGCAAGGGACATCAAGCATGCAATTCTCCCACCATTACGAGGGACATCAAGGTCTTAGGGACATCAAGATCAAGATAGGGACATCAAGAGGGACATCAAAGGAGGGACATCAAGTTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAATTGTGCCGACAA'
k = 12
L = 515
t = 18
res = ClumpFinding(genome, k, L, t)
' '.join(res)


file = open('./E_coli.txt')
Genome = file.read()
Genome = Genome.rstrip()
k = 9
L = 500
t = 3
res = FastestClumpFinding(Genome, k, L, t)
len(res)


